import{_ as oe,r as u,c as b,o as he,l as q,v as A,n as m,d as t,a8 as j,A as x,q as s,t as se,u as de,aM as U,M as g,bn as ne,a9 as ue,b as ie,bo as me,bb as ce,aa as pe,ab as ve,L as De,w as we,m as le,x as M,F as xe,Q as W}from"./index.9310f85f.js";import{Q as _e,j as Se}from"./QSelect.b3938c45.js";import{Q as Ce}from"./QTd.465b47f1.js";import{Q as ae}from"./QTable.5f112812.js";import{Q as Oe}from"./QPagination.e3ae685e.js";import{u as fe,Q as be}from"./QSpinnerFacebook.790b63a8.js";import{u as ge}from"./general.92b80929.js";import{e as qe}from"./exportToExcel.602deb22.js";import{Q as Ve}from"./TouchPan.ae3eb169.js";import{Q as Te}from"./QScrollArea.3b95b6af.js";import{Q as Ne}from"./QForm.af538d0b.js";import{Q as Pe}from"./QFile.27ecbe0d.js";import{_ as re}from"./CustomTooltip.2d9edaa3.js";import"./format.556c102f.js";import"./QList.302166dc.js";import"./QMarkupTable.ddbc83e5.js";import"./axios.e06b1dc4.js";import"./touch.3df10340.js";import"./QResizeObserver.79cc6745.js";import"./QScrollObserver.a818bd3f.js";const F=y=>(pe("data-v-5b758faf"),y=y(),ve(),y),Ue=F(()=>s("div",{class:"text-h6 text-bold",style:{color:"#123499"}}," Edit Order Details ",-1)),Ie={class:"text-bold"},Ae={class:"text-green"},Fe=F(()=>s("div",{class:"text-bold q-mt-md"},"Delivery Date",-1)),Qe=F(()=>s("div",{class:"text-bold q-mt-md"},"Courier Date",-1)),ke=F(()=>s("div",{class:"text-bold q-mt-md"},"Courier Tracking Number",-1)),$e=F(()=>s("div",{class:"text-bold q-mt-xs"},"Name of the Courier",-1)),Re=F(()=>s("div",{class:"text-bold q-mt-xs"},"Delivery Address",-1)),Me=F(()=>s("div",{class:"text-bold q-mt-xs"},"Order Status",-1)),Ge={__name:"editOrderDetailsModal",props:{showNewUserPopup:{type:Boolean,required:!0,default:!1},closeNewUserPopup:{type:Function,required:!0},selectedData:{type:Object,required:!0}},setup(y){const o=y,v=ge(),p=fe(),_=u(""),h=u(""),S=u(o.selectedData[0].delivery_number),c=u(o.selectedData[0].customer_name),w=u(o.selectedData[0].delivery_through),D=u(""),V=u(o.selectedData[0].order_status);let T=[{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In Transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const f=b({get:()=>o.showNewUserPopup,set:()=>o.closeNewUserPopup()}),Q=b(()=>T.map(i=>i.name)),G=b(()=>["Yet to be Couriered","Delivered","Cancelled"].includes(o.selectedData[0].order_status)),N=b(()=>o.selectedData[0].order_status!=="Yet to be Couriered"),C=b(()=>o.selectedData[0].order_status==="In Transit"),O=b(()=>o.selectedData[0].order_status==="In Transit"),L=b(()=>o.selectedData[0].order_status==="In Transit"),z=b(()=>T.find(n=>n.name===V.value).label),J=b(()=>{let i=P(S.value),n=P(w.value),d=P(D.value),B=V.value==="Yet to be Couriered",I=V.value==="In Transit",K=V.value==="Delivered",Z=I&&h.value,ee=K&&_.value;return h.value&&_.value&&h.value>_.value||o.selectedData[0].order_status==="In Transit"&&!_.value||I&&_.value?!0:K?!ee:!i||!n||!d||B||!Z}),E=()=>{p.loading.show({spinner:be,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},X=()=>{p.loading.hide()},k=(i=!1)=>{o.closeNewUserPopup(i)},P=i=>i&&i.toString().trim().length>0,$=()=>{let i=o.selectedData[0].order_status;i!=="Yet to be Couriered"&&(i==="In Transit"?T=[{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}]:(i==="Delivered"||i==="Cancelled")&&(T=[]))},R=i=>{const[n,d,B]=i.split("-");return`${B}-${d}-${n}`},Y=()=>{var n;E();let i={delivery_date:(n=_.value)!=null?n:null,courier_date:h.value,delivery_details:{delivery_through:w.value,delivery_number:S.value,delivery_address:D.value},order_status:z.value};v.updateOrders(i,o.selectedData[0].uid).then(d=>{k(!0),p.notify({message:"Order Details Updated Successfully!!!",type:"positive",position:"top"})}).catch(d=>{p.notify({message:"Something went Wrong. Please contact your admin!!!",type:"negative",position:"top"})}).finally(()=>{X()})};return he(()=>{o.selectedData[0].courier_date&&(h.value=R(o.selectedData[0].courier_date)),o.selectedData[0].delivery_date&&(_.value=R(o.selectedData[0].delivery_date)),o.selectedData[0].delivery_address||(D.value=o.selectedData[0].customer_address),$()}),(i,n)=>(q(),A(ce,{modelValue:g(f),"onUpdate:modelValue":n[6]||(n[6]=d=>ie(f)?f.value=d:null),persistent:"",onKeydown:me(k,["esc"])},{default:m(()=>[t(ue,{class:"order-modal"},{default:m(()=>[t(j,{class:"row items-center"},{default:m(()=>[Ue,t(Ve),t(x,{icon:"close",flat:"",round:"",onClick:k})]),_:1}),t(Ne,{onSubmit:Y},{default:m(()=>[t(Te,{style:{height:"calc(75vh - 170px)"}},{default:m(()=>[t(j,null,{default:m(()=>[s("div",Ie,[se(" Customer - "),s("span",Ae,de(c.value),1)]),Fe,t(U,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=d=>_.value=d),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:g(G)},null,8,["modelValue","disable"]),Qe,t(U,{modelValue:h.value,"onUpdate:modelValue":n[1]||(n[1]=d=>h.value=d),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:g(N)},null,8,["modelValue","disable"]),ke,t(U,{modelValue:S.value,"onUpdate:modelValue":n[2]||(n[2]=d=>S.value=d),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Courier Tracking Number",maxlength:"128",rules:[d=>P(d)||"Field is required!!!"],disable:g(C)},null,8,["modelValue","rules","disable"]),$e,t(U,{modelValue:w.value,"onUpdate:modelValue":n[3]||(n[3]=d=>w.value=d),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Name of the Courier",maxlength:"128",rules:[d=>P(d)||"Field is required!!!"],disable:g(O)},null,8,["modelValue","rules","disable"]),Re,t(U,{modelValue:D.value,"onUpdate:modelValue":n[4]||(n[4]=d=>D.value=d),type:"textarea",style:{width:"400px"},outlined:"",dense:"",autofocus:"",rows:"2",placeholder:"Enter Delivery address.","input-class":"textarea-input",rules:[d=>P(d)||"Field is required!!!"],disable:g(L)},null,8,["modelValue","rules","disable"]),Me,t(_e,{style:{width:"320px"},filled:"",modelValue:V.value,"onUpdate:modelValue":n[5]||(n[5]=d=>V.value=d),options:g(Q)},null,8,["modelValue","options"])]),_:1})]),_:1}),t(j,{class:"row justify-end"},{default:m(()=>[t(ne,{class:"q-px-none"},{default:m(()=>[t(x,{unelevated:"",color:"primary",label:"Save",type:"submit","no-caps":"",disable:g(J)},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var Ee=oe(Ge,[["__scopeId","data-v-5b758faf"]]);const Ye=y=>(pe("data-v-5f7d7a00"),y=y(),ve(),y),Be=Ye(()=>s("div",{class:"text-h6 text-bold text-center q-mt-lg q-pb-lg",style:{color:"#123499"}}," Orders File Upload ",-1)),je={style:{height:"50px"}},Le={__name:"openOrdersFileUploadModal",props:{showOrdersFileUploadPopup:{type:Boolean,required:!0,default:!1},closeOrdersFileUploadPopup:{type:Function,required:!0}},setup(y){const o=y,v=u(null),p=b({get:()=>o.showOrdersFileUploadPopup,set:()=>o.closeOrdersFileUploadPopup()}),_=b(()=>!v.value),h=()=>{let S=v.value&&v.value.length;o.closeOrdersFileUploadPopup(S)};return(S,c)=>(q(),A(ce,{modelValue:g(p),"onUpdate:modelValue":c[1]||(c[1]=w=>ie(p)?p.value=w:null),persistent:"",onKeydown:me(h,["esc"])},{default:m(()=>[t(ue,{class:"orders-file-upload-modal"},{default:m(()=>[t(j,{class:"items-center"},{default:m(()=>[t(x,{icon:"close",class:"float-right",flat:"",round:"",onClick:h}),Be,s("div",je,[t(Pe,{outlined:"",modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=w=>v.value=w),accept:".csv",label:"Upload File",class:"q-px-lg"},null,8,["modelValue"])])]),_:1}),t(j,{class:"row justify-end"},{default:m(()=>[t(ne,{class:"q-px-none"},{default:m(()=>[t(x,{unelevated:"",color:"primary",label:"Upload",disable:g(_),type:"submit","no-caps":""},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var Ke=oe(Le,[["__scopeId","data-v-5f7d7a00"]]);const He={class:"row q-pt-md q-ml-lg"},We={class:"col-2"},ze=s("p",{style:{color:"#123499"},class:"text-bold"},"Order From Date",-1),Je={class:"col-2"},Xe=s("p",{style:{color:"#123499"},class:"text-bold"},"Order To Date",-1),Ze={class:"col-2"},et=s("p",{style:{color:"#123499"},class:"text-bold"},"Courier Status",-1),tt={class:"col-2 q-ml-lg q-mt-lg"},lt={class:"q-ml-md q-mt-lg q-mr-lg q-pa-md"},at={class:"row justify-start items-center"},rt=s("span",{class:"q-ml-sm"},null,-1),ot={class:"row justify-start items-center"},st=s("span",{class:"q-ml-sm"},null,-1),dt={class:"row justify-start items-center"},nt=s("span",{class:"q-ml-sm"},null,-1),ut={class:"q-pa-lg flex flex-center"},it={key:0,class:"q-ml-md q-mt-sm q-mr-lg q-pa-md"},Pt={__name:"OrdersPage",setup(y){const o=ge(),v=u(!1),p=u(!1),{orders:_}=De(o);let h=[{name:"orderId",required:!0,label:"Order Id",align:"left",field:l=>l.order_id,format:l=>`${l}`,sortable:!0},{name:"orderDate",label:"Order Date",field:"order_date",sortable:!0,align:"center"},{name:"customerName",label:"Customer Name",field:"customer_name",align:"center"},{name:"mobileNumber",label:"Mobile Number",field:"mobile_number",align:"center"},{name:"referrerId",label:"Referrer Id",field:"referrer_id",align:"center"},{name:"referrerName",label:"Referrer Name",field:"referrer_name",align:"center"},{name:"referrerMobileNumber",label:"Referrer Mobile Number",field:"referrer_mobile_number",align:"center"},{name:"totalProductPrice",label:"Total Product Price",field:"total_product_price",align:"center"},{name:"cgst",label:"CGST Amount",field:"order_cgst_amount",align:"center"},{name:"sgst",label:"SGST Amount",field:"order_sgst_amount",align:"center"},{name:"igst",label:"IGST Amount",field:"order_igst_amount",align:"center"},{name:"gstTotal",label:"GST Total Amount",field:"order_gst_total_amount",align:"center"},{name:"orderTotal",label:"Order Total Amount",field:"order_total_amount",align:"center"},{name:"orderStatus",label:"Order Status",field:"order_status",align:"center"},{name:"courierDate",label:"Courier Date",field:"courier_date",align:"center"},{name:"deliveryThrough",label:"Courier Company Name",field:"delivery_through",align:"center"},{name:"deliveryNumber",label:"Courier Tracking Number",field:"delivery_number",align:"center"},{name:"deliveryAddress",label:"Delivery Address",field:"delivery_address",align:"center"},{name:"deliveryDate",label:"Delivery Date",field:"delivery_date",align:"center"},{name:"paymentMode",label:"Payment Mode",field:"payment_mode",align:"center"},{name:"paymentStatus",label:"Payment Status",field:"payment_status",align:"center"},{name:"paymentDate",label:"Payment Date",field:"payment_date",align:"center"},{name:"paymentReference",label:"Payment Reference",field:"payment_reference",align:"center"}],S=[{name:"uid",required:!0,label:"Order Item Id",align:"left",field:l=>l.order_item_number,format:l=>`${l}`,sortable:!0},{name:"productName",label:"Product Name",field:"product_name",align:"center"},{name:"quantity",label:"Quantity",field:"quantity",align:"center"},{name:"hsnCode",label:"HSN Code",field:"hsn_code",align:"center"},{name:"price",label:"Price (INR)",field:"price",align:"center"},{name:"cgstPercentage",label:"CGST (%)",field:"cgst_percentage",align:"center"},{name:"cgstAmount",label:"CGST Amount (INR)",field:"cgst_amount",align:"center"},{name:"sgstPercentage",label:"SGST (%)",field:"sgst_percentage",align:"center"},{name:"sgstAmount",label:"SGST Amount (INR)",field:"sgst_amount",align:"center"},{name:"igstPercentage",label:"IGST (%)",field:"igst_percentage",align:"center"},{name:"igstAmount",label:"IGST Amount (INR)",field:"igst_amount",align:"center"},{name:"gstTotalAmount",label:"GST Total (INR)",field:"gst_total_amount",align:"center"},{name:"totalAmount",label:"Total (INR)",field:"total_amount",align:"center"}];const c=u({page:1,rowsPerPage:10,rowsNumber:10,totalPages:0}),w=u(h),D=u([]),V=u(S),T=u([]),f=u([]),Q=u(""),G=u(!1),N=u("All"),C=u(""),O=u("");let L=[{label:"all",name:"All"},{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const z=u("Orders Template Download"),J=u("Orders Data Upload"),E=fe(),X=b(()=>L.map(l=>l.name)),k=b(()=>L.find(e=>e.name===N.value).label),P=l=>{c.value.page=l,I()},$=b(()=>!C.value||!O.value),R=()=>{E.loading.show({spinner:be,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},Y=()=>{E.loading.hide()},i=(l=!1)=>{v.value=!1,l===!0&&(f.value=[],I())},n=(l=!1)=>{p.value=!1,l===!0&&I()},d=()=>{v.value=!0},B=l=>l==="Yet to be Couriered"?"orange":l==="In Transit"?"purple":l==="Delivered"?"green":"red",I=()=>{R();let l={fromDate:C.value,toDate:O.value,orderStatus:k.value,page:c.value.page,rowsPerPage:10};o.getOrders(l).then(e=>{var a,r,H;console.log("res",c.value),_.value=(a=e.data)==null?void 0:a.data,D.value=[...(r=e.data)==null?void 0:r.data],c.value.totalPages=(H=e.data)==null?void 0:H.total_page_count}).catch(e=>{console.log("errror",e)}).finally(()=>{Y()})},K=l=>{o.searchOrderNumber(l.filter).then(e=>{D.value=e.data}).catch(e=>{console.log("err",e)}),console.log(l)},Z=()=>{let l=_.value.find(e=>e.order_id===f.value[0].order_id).order_items;T.value=l},ee=()=>{if(O.value<C.value){E.notify({message:"Order From Date should be less than or equal to Order To Date!!!",type:"warning",position:"top"});return}f.value=[],I()},te=()=>{R();let l={fromDate:C.value,toDate:O.value,orderStatus:k.value};o.getOrdersCsvTemplate(l).then(e=>{let a=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=a,r.setAttribute("download","Yet_To_Be_Couriered_Orders.csv"),document.body.appendChild(r),r.click(),r.remove()}).catch(e=>{console.log("err",e)}).finally(()=>{Y()})},ye=()=>{R();let l=N.value.replace(/ /g,"_"),e="Registration_Payments_All.xlsx";$.value||(e=`Registration_Payments_${l}_from_${C.value}_to_${O.value}.xlsx`);let a=[];for(let r of D.value){let H={"Order Id":r.order_id,"Order Date":r.order_date,"Customer Name":r.customer_name,"Mobile Number":r.mobile_number,"Referrer Id":r.referrer_id,"Referrer Name":r.referrer_name,"Referrer Mobile Number":r.referrer_mobile_number,"Total Product Price":r.total_product_price,"CGST Amount":r.order_cgst_amount,"SGST Amount":r.order_sgst_amount,"IGST Amount":r.order_igst_amount,"GST Total Amount":r.order_gst_total_amount,"Order Total Amount":r.order_total_amount,"Order Status":r.order_status,"Courier Date":r.courier_date,"Courier Company Name":r.delivery_through,"Courier Tracking Number":r.delivery_number,"Delivery Address":r.delivery_address,"Delivery Date":r.delivery_date,"Payment Mode":r.payment_mode,"Payment Status":r.payment_status,"Payment Date":r.payment_date};a.push(H)}qe(a,e),Y()};return we(f,l=>{l.length?Z():T.value=[]}),(l,e)=>(q(),le(xe,null,[s("div",He,[s("div",We,[ze,t(U,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=a=>C.value=a),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),s("div",Je,[Xe,t(U,{modelValue:O.value,"onUpdate:modelValue":e[1]||(e[1]=a=>O.value=a),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),s("div",Ze,[et,t(_e,{filled:"",dense:"",style:{width:"200px","max-height":"100px"},modelValue:N.value,"onUpdate:modelValue":e[2]||(e[2]=a=>N.value=a),options:g(X)},null,8,["modelValue","options"])]),s("div",tt,[t(x,{unelevated:"",color:"primary",label:"Search","no-caps":"",disable:g($),onClick:ee},null,8,["disable"])])]),s("div",lt,[s("div",null,[t(x,{color:"green",class:"q-mb-md",style:{width:"20px"},"no-caps":"",onClick:ye},{default:m(()=>[s("div",at,[t(W,{name:"fas fa-file-excel"}),rt])]),_:1}),N.value==="Yet to be Couriered"?(q(),A(x,{key:0,color:"primary",class:"q-mb-md float-right",style:{width:"20px"},"no-caps":"",disable:g($)||!D.value.length,onClick:e[3]||(e[3]=a=>p.value=!0)},{default:m(()=>[t(re,{content:J.value,"max-width":"20rem"},null,8,["content"]),s("div",ot,[t(W,{name:"fas fa-upload"}),st])]),_:1},8,["disable"])):M("",!0),N.value==="Yet to be Couriered"?(q(),A(x,{key:1,color:"primary",class:"q-mb-md float-right q-mr-md",style:{width:"20px"},"no-caps":"",disable:g($)||!D.value.length,onClick:te},{default:m(()=>[t(re,{content:z.value,"max-width":"20rem"},null,8,["content"]),s("div",dt,[t(W,{name:"fas fa-download"}),nt])]),_:1},8,["disable"])):M("",!0)]),t(ae,{ref:l.orderTable,class:"orders-table",flat:"",bordered:"",title:"Orders",rows:D.value,columns:w.value,pagination:c.value,"onUpdate:pagination":e[6]||(e[6]=a=>c.value=a),"row-key":"order_id",onRequest:K,selected:f.value,"onUpdate:selected":e[7]||(e[7]=a=>f.value=a),filter:Q.value},{"top-right":m(()=>[G.value?(q(),A(U,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:Q.value,"onUpdate:modelValue":e[4]||(e[4]=a=>Q.value=a),placeholder:"Search"},{append:m(()=>[t(W,{name:"search"})]),_:1},8,["modelValue"])):M("",!0),t(x,{class:"q-ml-sm",icon:"filter_list",onClick:e[5]||(e[5]=a=>G.value=!G.value),flat:""})]),"body-cell-orderStatus":m(a=>[t(Ce,{props:a},{default:m(()=>[t(Se,{color:B(a.row.order_status),"text-color":"white",dense:"",class:"text-weight-bolder",square:""},{default:m(()=>[se(de(a.row.order_status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","selected","filter"]),s("div",ut,[t(Oe,{modelValue:c.value.page,"onUpdate:modelValue":[e[8]||(e[8]=a=>c.value.page=a),P],max:c.value.totalPages,"max-pages":6,"boundary-numbers":!0,ellipses:!0},null,8,["modelValue","max"])]),t(x,{class:"q-mt-md",color:"primary",label:"Edit",disable:!f.value.length||f.value[0].order_status==="Delivered",onClick:d},null,8,["disable"])]),f.value.length?(q(),le("div",it,[t(ae,{class:"orders-table",flat:"",bordered:"",title:"Order Items",rows:T.value,columns:V.value,"row-key":"order_id",filter:Q.value},null,8,["rows","columns","filter"])])):M("",!0),v.value?(q(),A(Ee,{key:1,modelValue:v.value,"onUpdate:modelValue":e[9]||(e[9]=a=>v.value=a),"show-new-user-popup":v.value,"close-new-user-popup":i,"selected-data":f.value},null,8,["modelValue","show-new-user-popup","selected-data"])):M("",!0),p.value?(q(),A(Ke,{key:2,modelValue:p.value,"onUpdate:modelValue":e[10]||(e[10]=a=>p.value=a),"show-orders-file-upload-popup":p.value,"close-orders-file-upload-popup":n},null,8,["modelValue","show-orders-file-upload-popup"])):M("",!0)],64))}};export{Pt as default};
