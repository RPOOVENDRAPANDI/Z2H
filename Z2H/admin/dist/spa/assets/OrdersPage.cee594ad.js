import{_ as te,r as u,c as f,o as le,l as N,v as k,n as m,d as e,a8 as M,A as w,q as o,t as ae,u as re,aM as T,M as h,bn as oe,a9 as se,b as de,bo as ne,bb as ie,aa as ue,ab as me,L as be,w as ge,m as X,x as Y,F as ye,Q as L}from"./index.18d27cdb.js";import{Q as ce,j as he}from"./QSelect.84360b9a.js";import{Q as De}from"./QTd.5de48559.js";import{Q as Z}from"./QTable.c0b30b8a.js";import{u as pe,Q as _e}from"./QSpinnerFacebook.d84b28a4.js";import{u as ve}from"./general.acaf71e2.js";import{e as we}from"./exportToExcel.4db6e6be.js";import{Q as xe}from"./TouchPan.5b63350d.js";import{Q as Se}from"./QScrollArea.e8318baa.js";import{Q as Ce}from"./QForm.8d65543b.js";import{Q as Oe}from"./QFile.e7e446f9.js";import{_ as ee}from"./CustomTooltip.8a52884a.js";import"./format.c5e89796.js";import"./QList.6b773e4f.js";import"./QMarkupTable.24b67161.js";import"./axios.621c1308.js";import"./touch.3df10340.js";import"./QResizeObserver.d350a8c4.js";import"./QScrollObserver.fd7d4aab.js";const U=b=>(ue("data-v-f8194a3e"),b=b(),me(),b),qe=U(()=>o("div",{class:"text-h6 text-bold",style:{color:"#123499"}}," Edit Order Details ",-1)),Ve={class:"text-bold"},Te={class:"text-green"},Ne=U(()=>o("div",{class:"text-bold q-mt-md"},"Delivery Date",-1)),Ue=U(()=>o("div",{class:"text-bold q-mt-md"},"Courier Date",-1)),Ie=U(()=>o("div",{class:"text-bold q-mt-md"},"Courier Tracking Number",-1)),Pe=U(()=>o("div",{class:"text-bold q-mt-xs"},"Name of the Courier",-1)),Ae=U(()=>o("div",{class:"text-bold q-mt-xs"},"Delivery Address",-1)),Fe=U(()=>o("div",{class:"text-bold q-mt-xs"},"Order Status",-1)),Qe={__name:"editOrderDetailsModal",props:{showNewUserPopup:{type:Boolean,required:!0,default:!1},closeNewUserPopup:{type:Function,required:!0},selectedData:{type:Object,required:!0}},setup(b){const r=b,_=ve(),c=pe(),v=u(""),g=u(""),x=u(r.selectedData[0].delivery_number),C=u(r.selectedData[0].customer_name),y=u(r.selectedData[0].delivery_through),I=u(r.selectedData[0].delivery_address),D=u(r.selectedData[0].order_status);let p=[{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In Transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const O=f({get:()=>r.showNewUserPopup,set:()=>r.closeNewUserPopup()}),F=f(()=>p.map(n=>n.name)),P=f(()=>["Yet to be Couriered","Delivered","Cancelled"].includes(r.selectedData[0].order_status)),q=f(()=>r.selectedData[0].order_status!=="Yet to be Couriered"),V=f(()=>r.selectedData[0].order_status==="In Transit"),R=f(()=>r.selectedData[0].order_status==="In Transit"),K=f(()=>r.selectedData[0].order_status==="In Transit"),H=f(()=>p.find(s=>s.name===D.value).label),Q=f(()=>{let n=S(x.value),s=S(y.value),l=S(I.value),$=D.value==="Yet to be Couriered",j=D.value==="In Transit",B=D.value==="Delivered",a=j&&g.value,t=B&&v.value;return g.value&&v.value&&g.value>v.value||r.selectedData[0].order_status==="In Transit"&&!v.value||j&&v.value?!0:B?!t:!n||!s||!l||$||!a}),W=()=>{c.loading.show({spinner:_e,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},z=()=>{c.loading.hide()},A=(n=!1)=>{r.closeNewUserPopup(n)},S=n=>n&&n.toString().trim().length>0,G=()=>{let n=r.selectedData[0].order_status;n!=="Yet to be Couriered"&&(n==="In Transit"?p=[{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}]:(n==="Delivered"||n==="Cancelled")&&(p=[]))},E=n=>{const[s,l,$]=n.split("-");return`${$}-${l}-${s}`},J=()=>{var s;W();let n={delivery_date:(s=v.value)!=null?s:null,courier_date:g.value,delivery_details:{delivery_through:y.value,delivery_number:x.value,delivery_address:I.value},order_status:H.value};_.updateOrders(n,r.selectedData[0].uid).then(l=>{A(!0),c.notify({message:"Order Details Updated Successfully!!!",type:"positive",position:"top"})}).catch(l=>{c.notify({message:"Something went Wrong. Please contact your admin!!!",type:"negative",position:"top"})}).finally(()=>{z()})};return le(()=>{r.selectedData[0].courier_date&&(g.value=E(r.selectedData[0].courier_date)),r.selectedData[0].delivery_date&&(v.value=E(r.selectedData[0].delivery_date)),G()}),(n,s)=>(N(),k(ie,{modelValue:h(O),"onUpdate:modelValue":s[6]||(s[6]=l=>de(O)?O.value=l:null),persistent:"",onKeydown:ne(A,["esc"])},{default:m(()=>[e(se,{class:"order-modal"},{default:m(()=>[e(M,{class:"row items-center"},{default:m(()=>[qe,e(xe),e(w,{icon:"close",flat:"",round:"",onClick:A})]),_:1}),e(Ce,{onSubmit:J},{default:m(()=>[e(Se,{style:{height:"calc(75vh - 170px)"}},{default:m(()=>[e(M,null,{default:m(()=>[o("div",Ve,[ae(" Customer - "),o("span",Te,re(C.value),1)]),Ne,e(T,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=l=>v.value=l),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:h(P)},null,8,["modelValue","disable"]),Ue,e(T,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=l=>g.value=l),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:h(q)},null,8,["modelValue","disable"]),Ie,e(T,{modelValue:x.value,"onUpdate:modelValue":s[2]||(s[2]=l=>x.value=l),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Courier Tracking Number",maxlength:"128",rules:[l=>S(l)||"Field is required!!!"],disable:h(V)},null,8,["modelValue","rules","disable"]),Pe,e(T,{modelValue:y.value,"onUpdate:modelValue":s[3]||(s[3]=l=>y.value=l),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Name of the Courier",maxlength:"128",rules:[l=>S(l)||"Field is required!!!"],disable:h(R)},null,8,["modelValue","rules","disable"]),Ae,e(T,{modelValue:I.value,"onUpdate:modelValue":s[4]||(s[4]=l=>I.value=l),type:"textarea",style:{width:"400px"},outlined:"",dense:"",autofocus:"",rows:"2",placeholder:"Enter Delivery address.","input-class":"textarea-input",rules:[l=>S(l)||"Field is required!!!"],disable:h(K)},null,8,["modelValue","rules","disable"]),Fe,e(ce,{style:{width:"320px"},filled:"",modelValue:D.value,"onUpdate:modelValue":s[5]||(s[5]=l=>D.value=l),options:h(F)},null,8,["modelValue","options"])]),_:1})]),_:1}),e(M,{class:"row justify-end"},{default:m(()=>[e(oe,{class:"q-px-none"},{default:m(()=>[e(w,{unelevated:"",color:"primary",label:"Save",type:"submit","no-caps":"",disable:h(Q)},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var $e=te(Qe,[["__scopeId","data-v-f8194a3e"]]);const ke=b=>(ue("data-v-31d6ec31"),b=b(),me(),b),Me=ke(()=>o("div",{class:"text-h6 text-bold text-center q-mt-lg q-pb-lg",style:{color:"#123499"}}," Orders File Upload ",-1)),Re={style:{height:"50px"}},Ge={__name:"openOrdersFileUploadModal",props:{showOrdersFileUploadPopup:{type:Boolean,required:!0,default:!1},closeOrdersFileUploadPopup:{type:Function,required:!0}},setup(b){const r=b,_=u(null),c=f({get:()=>r.showOrdersFileUploadPopup,set:()=>r.closeOrdersFileUploadPopup()}),v=f(()=>!_.value),g=()=>{let x=_.value&&_.value.length;r.closeOrdersFileUploadPopup(x)};return(x,C)=>(N(),k(ie,{modelValue:h(c),"onUpdate:modelValue":C[1]||(C[1]=y=>de(c)?c.value=y:null),persistent:"",onKeydown:ne(g,["esc"])},{default:m(()=>[e(se,{class:"orders-file-upload-modal"},{default:m(()=>[e(M,{class:"items-center"},{default:m(()=>[e(w,{icon:"close",class:"float-right",flat:"",round:"",onClick:g}),Me,o("div",Re,[e(Oe,{outlined:"",modelValue:_.value,"onUpdate:modelValue":C[0]||(C[0]=y=>_.value=y),accept:".xlsx",label:"Upload File",class:"q-px-lg"},null,8,["modelValue"])])]),_:1}),e(M,{class:"row justify-end"},{default:m(()=>[e(oe,{class:"q-px-none"},{default:m(()=>[e(w,{unelevated:"",color:"primary",label:"Upload",disable:h(v),type:"submit","no-caps":""},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var Ee=te(Ge,[["__scopeId","data-v-31d6ec31"]]);const je={class:"row q-pt-md q-ml-lg"},Be={class:"col-2"},Ye=o("p",{style:{color:"#123499"},class:"text-bold"},"Order From Date",-1),Le={class:"col-2"},Ke=o("p",{style:{color:"#123499"},class:"text-bold"},"Order To Date",-1),He={class:"col-2"},We=o("p",{style:{color:"#123499"},class:"text-bold"},"Courier Status",-1),ze={class:"col-2 q-ml-lg q-mt-lg"},Je={class:"q-ml-md q-mt-lg q-mr-lg q-pa-md"},Xe={class:"row justify-start items-center"},Ze=o("span",{class:"q-ml-sm"},null,-1),et={class:"row justify-start items-center"},tt=o("span",{class:"q-ml-sm"},null,-1),lt={class:"row justify-start items-center"},at=o("span",{class:"q-ml-sm"},null,-1),rt={key:0,class:"q-ml-md q-mt-sm q-mr-lg q-pa-md"},St={__name:"OrdersPage",setup(b){const r=ve(),_=u(!1),c=u(!1),{orders:v}=be(r);let g=[{name:"orderId",required:!0,label:"Order Id",align:"left",field:a=>a.order_id,format:a=>`${a}`,sortable:!0},{name:"orderDate",label:"Order Date",field:"order_date",sortable:!0,align:"center"},{name:"customerName",label:"Customer Name",field:"customer_name",align:"center"},{name:"mobileNumber",label:"Mobile Number",field:"mobile_number",align:"center"},{name:"referrerId",label:"Referrer Id",field:"referrer_id",align:"center"},{name:"referrerName",label:"Referrer Name",field:"referrer_name",align:"center"},{name:"referrerMobileNumber",label:"Referrer Mobile Number",field:"referrer_mobile_number",align:"center"},{name:"totalProductPrice",label:"Total Product Price",field:"total_product_price",align:"center"},{name:"cgst",label:"CGST Amount",field:"order_cgst_amount",align:"center"},{name:"sgst",label:"SGST Amount",field:"order_sgst_amount",align:"center"},{name:"igst",label:"IGST Amount",field:"order_igst_amount",align:"center"},{name:"gstTotal",label:"GST Total Amount",field:"order_gst_total_amount",align:"center"},{name:"orderTotal",label:"Order Total Amount",field:"order_total_amount",align:"center"},{name:"orderStatus",label:"Order Status",field:"order_status",align:"center"},{name:"courierDate",label:"Courier Date",field:"courier_date",align:"center"},{name:"deliveryThrough",label:"Courier Company Name",field:"delivery_through",align:"center"},{name:"deliveryNumber",label:"Courier Tracking Number",field:"delivery_number",align:"center"},{name:"deliveryAddress",label:"Delivery Address",field:"delivery_address",align:"center"},{name:"deliveryDate",label:"Delivery Date",field:"delivery_date",align:"center"},{name:"paymentMode",label:"Payment Mode",field:"payment_mode",align:"center"},{name:"paymentStatus",label:"Payment Status",field:"payment_status",align:"center"},{name:"paymentDate",label:"Payment Date",field:"payment_date",align:"center"},{name:"paymentReference",label:"Payment Reference",field:"payment_reference",align:"center"}],x=[{name:"uid",required:!0,label:"Order Item Id",align:"left",field:a=>a.order_item_number,format:a=>`${a}`,sortable:!0},{name:"productName",label:"Product Name",field:"product_name",align:"center"},{name:"quantity",label:"Quantity",field:"quantity",align:"center"},{name:"hsnCode",label:"HSN Code",field:"hsn_code",align:"center"},{name:"price",label:"Price (INR)",field:"price",align:"center"},{name:"cgstPercentage",label:"CGST (%)",field:"cgst_percentage",align:"center"},{name:"cgstAmount",label:"CGST Amount (INR)",field:"cgst_amount",align:"center"},{name:"sgstPercentage",label:"SGST (%)",field:"sgst_percentage",align:"center"},{name:"sgstAmount",label:"SGST Amount (INR)",field:"sgst_amount",align:"center"},{name:"igstPercentage",label:"IGST (%)",field:"igst_percentage",align:"center"},{name:"igstAmount",label:"IGST Amount (INR)",field:"igst_amount",align:"center"},{name:"gstTotalAmount",label:"GST Total (INR)",field:"gst_total_amount",align:"center"},{name:"totalAmount",label:"Total (INR)",field:"total_amount",align:"center"}];const C=u(g),y=u([]),I=u(x),D=u([]),p=u([]),O=u(""),F=u(!1),P=u("All"),q=u(""),V=u("");let R=[{label:"all",name:"All"},{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const K=u("Orders Template Download"),H=u("Orders Data Upload"),Q=pe(),W=f(()=>R.map(a=>a.name)),z=f(()=>R.find(t=>t.name===P.value).label),A=f(()=>!q.value||!V.value),S=()=>{Q.loading.show({spinner:_e,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},G=()=>{Q.loading.hide()},E=(a=!1)=>{_.value=!1,a===!0&&(p.value=[],l())},J=(a=!1)=>{c.value=!1,a===!0&&l()},n=()=>{_.value=!0},s=a=>a==="Yet to be Couriered"?"orange":a==="In Transit"?"purple":a==="Delivered"?"green":"red",l=()=>{S();let a={fromDate:q.value,toDate:V.value,orderStatus:z.value};r.getOrders(a).then(t=>{v.value=t.data,y.value=t.data}).catch(t=>{console.log("errror",t)}).finally(()=>{G()})},$=()=>{let a=v.value.find(t=>t.order_id===p.value[0].order_id).order_items;D.value=a},j=()=>{if(V.value<q.value){Q.notify({message:"Order From Date should be less than or equal to Order To Date!!!",type:"warning",position:"top"});return}p.value=[],l()},B=()=>{S();let a=P.value.replace(/ /g,"_"),t="Registration_Payments_All.xlsx";A.value||(t=`Registration_Payments_${a}_from_${q.value}_to_${V.value}.xlsx`);let d=[];for(let i of y.value){let fe={"Order Id":i.order_id,"Order Date":i.order_date,"Customer Name":i.customer_name,"Mobile Number":i.mobile_number,"Referrer Id":i.referrer_id,"Referrer Name":i.referrer_name,"Referrer Mobile Number":i.referrer_mobile_number,"Total Product Price":i.total_product_price,"CGST Amount":i.order_cgst_amount,"SGST Amount":i.order_sgst_amount,"IGST Amount":i.order_igst_amount,"GST Total Amount":i.order_gst_total_amount,"Order Total Amount":i.order_total_amount,"Order Status":i.order_status,"Courier Date":i.courier_date,"Courier Company Name":i.delivery_through,"Courier Tracking Number":i.delivery_number,"Delivery Address":i.delivery_address,"Delivery Date":i.delivery_date,"Payment Mode":i.payment_mode,"Payment Status":i.payment_status,"Payment Date":i.payment_date};d.push(fe)}we(d,t),G()};return ge(p,a=>{a.length?$():D.value=[]}),le(()=>{l()}),(a,t)=>(N(),X(ye,null,[o("div",je,[o("div",Be,[Ye,e(T,{modelValue:q.value,"onUpdate:modelValue":t[0]||(t[0]=d=>q.value=d),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),o("div",Le,[Ke,e(T,{modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=d=>V.value=d),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),o("div",He,[We,e(ce,{filled:"",dense:"",style:{width:"200px","max-height":"100px"},modelValue:P.value,"onUpdate:modelValue":t[2]||(t[2]=d=>P.value=d),options:h(W)},null,8,["modelValue","options"])]),o("div",ze,[e(w,{unelevated:"",color:"primary",label:"Search","no-caps":"",disable:h(A),onClick:j},null,8,["disable"])])]),o("div",Je,[o("div",null,[e(w,{color:"green",class:"q-mb-md",style:{width:"20px"},"no-caps":"",onClick:B},{default:m(()=>[o("div",Xe,[e(L,{name:"fas fa-file-excel"}),Ze])]),_:1}),e(w,{color:"primary",class:"q-mb-md float-right",style:{width:"20px"},"no-caps":"",onClick:t[3]||(t[3]=d=>c.value=!0)},{default:m(()=>[e(ee,{content:H.value,"max-width":"20rem"},null,8,["content"]),o("div",et,[e(L,{name:"fas fa-upload"}),tt])]),_:1}),e(w,{color:"primary",class:"q-mb-md float-right q-mr-md",style:{width:"20px"},"no-caps":""},{default:m(()=>[e(ee,{content:K.value,"max-width":"20rem"},null,8,["content"]),o("div",lt,[e(L,{name:"fas fa-download"}),at])]),_:1})]),e(Z,{class:"orders-table",flat:"",bordered:"",title:"Orders",rows:y.value,columns:C.value,"row-key":"order_id",selection:"single",selected:p.value,"onUpdate:selected":t[6]||(t[6]=d=>p.value=d),filter:O.value},{"top-right":m(()=>[F.value?(N(),k(T,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:O.value,"onUpdate:modelValue":t[4]||(t[4]=d=>O.value=d),placeholder:"Search"},{append:m(()=>[e(L,{name:"search"})]),_:1},8,["modelValue"])):Y("",!0),e(w,{class:"q-ml-sm",icon:"filter_list",onClick:t[5]||(t[5]=d=>F.value=!F.value),flat:""})]),"body-cell-orderStatus":m(d=>[e(De,{props:d},{default:m(()=>[e(he,{color:s(d.row.order_status),"text-color":"white",dense:"",class:"text-weight-bolder",square:""},{default:m(()=>[ae(re(d.row.order_status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected","filter"]),e(w,{class:"q-mt-md",color:"primary",label:"Edit",disable:!p.value.length||p.value[0].order_status==="Delivered",onClick:n},null,8,["disable"])]),p.value.length?(N(),X("div",rt,[e(Z,{class:"orders-table",flat:"",bordered:"",title:"Order Items",rows:D.value,columns:I.value,"row-key":"order_id",filter:O.value},null,8,["rows","columns","filter"])])):Y("",!0),_.value?(N(),k($e,{key:1,modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=d=>_.value=d),"show-new-user-popup":_.value,"close-new-user-popup":E,"selected-data":p.value},null,8,["modelValue","show-new-user-popup","selected-data"])):Y("",!0),c.value?(N(),k(Ee,{key:2,modelValue:c.value,"onUpdate:modelValue":t[8]||(t[8]=d=>c.value=d),"show-orders-file-upload-popup":c.value,"close-orders-file-upload-popup":J},null,8,["modelValue","show-orders-file-upload-popup"])):Y("",!0)],64))}};export{St as default};
