import{_ as le,r as u,c as b,o as be,l as q,v as A,n as m,d as e,a8 as G,A as S,q as s,t as ae,u as re,aM as I,M as g,bn as oe,a9 as se,b as de,bo as ne,bb as ie,aa as ue,ab as me,L as ge,w as ye,m as Z,x as k,F as he,Q as K}from"./index.5c8a47da.js";import{Q as ce,j as De}from"./QSelect.a5799075.js";import{Q as we}from"./QTd.146b3053.js";import{Q as ee}from"./QTable.32b47f6a.js";import{u as pe,Q as _e}from"./QSpinnerFacebook.d7b9839a.js";import{u as ve}from"./general.57750345.js";import{e as Se}from"./exportToExcel.4db6e6be.js";import{Q as xe}from"./TouchPan.0ca4b38c.js";import{Q as Ce}from"./QScrollArea.aabbc4ec.js";import{Q as Oe}from"./QForm.c6d2cd18.js";import{Q as qe}from"./QFile.26b8cba6.js";import{_ as te}from"./CustomTooltip.d5dccf9d.js";import"./format.6e0d4b5c.js";import"./QList.4a0a137f.js";import"./QMarkupTable.d9075105.js";import"./axios.998f97b8.js";import"./touch.3df10340.js";import"./QResizeObserver.d932ce80.js";import"./QScrollObserver.6fa7ace6.js";const F=y=>(ue("data-v-c61ddd5e"),y=y(),me(),y),Te=F(()=>s("div",{class:"text-h6 text-bold",style:{color:"#123499"}}," Edit Order Details ",-1)),Ve={class:"text-bold"},Ne={class:"text-green"},Ue=F(()=>s("div",{class:"text-bold q-mt-md"},"Delivery Date",-1)),Ie=F(()=>s("div",{class:"text-bold q-mt-md"},"Courier Date",-1)),Pe=F(()=>s("div",{class:"text-bold q-mt-md"},"Courier Tracking Number",-1)),Ae=F(()=>s("div",{class:"text-bold q-mt-xs"},"Name of the Courier",-1)),Fe=F(()=>s("div",{class:"text-bold q-mt-xs"},"Delivery Address",-1)),ke=F(()=>s("div",{class:"text-bold q-mt-xs"},"Order Status",-1)),Qe={__name:"editOrderDetailsModal",props:{showNewUserPopup:{type:Boolean,required:!0,default:!1},closeNewUserPopup:{type:Function,required:!0},selectedData:{type:Object,required:!0}},setup(y){const a=y,_=ve(),c=pe(),v=u(""),h=u(""),x=u(a.selectedData[0].delivery_number),T=u(a.selectedData[0].customer_name),f=u(a.selectedData[0].delivery_through),P=u(""),D=u(a.selectedData[0].order_status);let p=[{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In Transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const V=b({get:()=>a.showNewUserPopup,set:()=>a.closeNewUserPopup()}),Q=b(()=>p.map(i=>i.name)),N=b(()=>["Yet to be Couriered","Delivered","Cancelled"].includes(a.selectedData[0].order_status)),C=b(()=>a.selectedData[0].order_status!=="Yet to be Couriered"),O=b(()=>a.selectedData[0].order_status==="In Transit"),E=b(()=>a.selectedData[0].order_status==="In Transit"),H=b(()=>a.selectedData[0].order_status==="In Transit"),W=b(()=>p.find(d=>d.name===D.value).label),$=b(()=>{let i=w(x.value),d=w(f.value),r=w(P.value),M=D.value==="Yet to be Couriered",j=D.value==="In Transit",L=D.value==="Delivered",X=j&&h.value,l=L&&v.value;return h.value&&v.value&&h.value>v.value||a.selectedData[0].order_status==="In Transit"&&!v.value||j&&v.value?!0:L?!l:!i||!d||!r||M||!X}),z=()=>{c.loading.show({spinner:_e,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},Y=()=>{c.loading.hide()},U=(i=!1)=>{a.closeNewUserPopup(i)},w=i=>i&&i.toString().trim().length>0,R=()=>{let i=a.selectedData[0].order_status;i!=="Yet to be Couriered"&&(i==="In Transit"?p=[{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}]:(i==="Delivered"||i==="Cancelled")&&(p=[]))},B=i=>{const[d,r,M]=i.split("-");return`${M}-${r}-${d}`},J=()=>{var d;z();let i={delivery_date:(d=v.value)!=null?d:null,courier_date:h.value,delivery_details:{delivery_through:f.value,delivery_number:x.value,delivery_address:P.value},order_status:W.value};_.updateOrders(i,a.selectedData[0].uid).then(r=>{U(!0),c.notify({message:"Order Details Updated Successfully!!!",type:"positive",position:"top"})}).catch(r=>{c.notify({message:"Something went Wrong. Please contact your admin!!!",type:"negative",position:"top"})}).finally(()=>{Y()})};return be(()=>{a.selectedData[0].courier_date&&(h.value=B(a.selectedData[0].courier_date)),a.selectedData[0].delivery_date&&(v.value=B(a.selectedData[0].delivery_date)),a.selectedData[0].delivery_address||(P.value=a.selectedData[0].customer_address),R()}),(i,d)=>(q(),A(ie,{modelValue:g(V),"onUpdate:modelValue":d[6]||(d[6]=r=>de(V)?V.value=r:null),persistent:"",onKeydown:ne(U,["esc"])},{default:m(()=>[e(se,{class:"order-modal"},{default:m(()=>[e(G,{class:"row items-center"},{default:m(()=>[Te,e(xe),e(S,{icon:"close",flat:"",round:"",onClick:U})]),_:1}),e(Oe,{onSubmit:J},{default:m(()=>[e(Ce,{style:{height:"calc(75vh - 170px)"}},{default:m(()=>[e(G,null,{default:m(()=>[s("div",Ve,[ae(" Customer - "),s("span",Ne,re(T.value),1)]),Ue,e(I,{modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=r=>v.value=r),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:g(N)},null,8,["modelValue","disable"]),Ie,e(I,{modelValue:h.value,"onUpdate:modelValue":d[1]||(d[1]=r=>h.value=r),style:{"max-width":"200px"},outlined:"",dense:"",autofocus:"",type:"date",disable:g(C)},null,8,["modelValue","disable"]),Pe,e(I,{modelValue:x.value,"onUpdate:modelValue":d[2]||(d[2]=r=>x.value=r),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Courier Tracking Number",maxlength:"128",rules:[r=>w(r)||"Field is required!!!"],disable:g(O)},null,8,["modelValue","rules","disable"]),Ae,e(I,{modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=r=>f.value=r),style:{"max-width":"400px"},outlined:"",dense:"",autofocus:"",placeholder:"Enter a Name of the Courier",maxlength:"128",rules:[r=>w(r)||"Field is required!!!"],disable:g(E)},null,8,["modelValue","rules","disable"]),Fe,e(I,{modelValue:P.value,"onUpdate:modelValue":d[4]||(d[4]=r=>P.value=r),type:"textarea",style:{width:"400px"},outlined:"",dense:"",autofocus:"",rows:"2",placeholder:"Enter Delivery address.","input-class":"textarea-input",rules:[r=>w(r)||"Field is required!!!"],disable:g(H)},null,8,["modelValue","rules","disable"]),ke,e(ce,{style:{width:"320px"},filled:"",modelValue:D.value,"onUpdate:modelValue":d[5]||(d[5]=r=>D.value=r),options:g(Q)},null,8,["modelValue","options"])]),_:1})]),_:1}),e(G,{class:"row justify-end"},{default:m(()=>[e(oe,{class:"q-px-none"},{default:m(()=>[e(S,{unelevated:"",color:"primary",label:"Save",type:"submit","no-caps":"",disable:g($)},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var $e=le(Qe,[["__scopeId","data-v-c61ddd5e"]]);const Re=y=>(ue("data-v-6d7b1b6c"),y=y(),me(),y),Me=Re(()=>s("div",{class:"text-h6 text-bold text-center q-mt-lg q-pb-lg",style:{color:"#123499"}}," Orders File Upload ",-1)),Ge={style:{height:"50px"}},Ee={__name:"openOrdersFileUploadModal",props:{showOrdersFileUploadPopup:{type:Boolean,required:!0,default:!1},closeOrdersFileUploadPopup:{type:Function,required:!0}},setup(y){const a=y,_=u(null),c=b({get:()=>a.showOrdersFileUploadPopup,set:()=>a.closeOrdersFileUploadPopup()}),v=b(()=>!_.value),h=()=>{let x=_.value&&_.value.length;a.closeOrdersFileUploadPopup(x)};return(x,T)=>(q(),A(ie,{modelValue:g(c),"onUpdate:modelValue":T[1]||(T[1]=f=>de(c)?c.value=f:null),persistent:"",onKeydown:ne(h,["esc"])},{default:m(()=>[e(se,{class:"orders-file-upload-modal"},{default:m(()=>[e(G,{class:"items-center"},{default:m(()=>[e(S,{icon:"close",class:"float-right",flat:"",round:"",onClick:h}),Me,s("div",Ge,[e(qe,{outlined:"",modelValue:_.value,"onUpdate:modelValue":T[0]||(T[0]=f=>_.value=f),accept:".csv",label:"Upload File",class:"q-px-lg"},null,8,["modelValue"])])]),_:1}),e(G,{class:"row justify-end"},{default:m(()=>[e(oe,{class:"q-px-none"},{default:m(()=>[e(S,{unelevated:"",color:"primary",label:"Upload",disable:g(v),type:"submit","no-caps":""},null,8,["disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"]))}};var Ye=le(Ee,[["__scopeId","data-v-6d7b1b6c"]]);const Be={class:"row q-pt-md q-ml-lg"},je={class:"col-2"},Le=s("p",{style:{color:"#123499"},class:"text-bold"},"Order From Date",-1),Ke={class:"col-2"},He=s("p",{style:{color:"#123499"},class:"text-bold"},"Order To Date",-1),We={class:"col-2"},ze=s("p",{style:{color:"#123499"},class:"text-bold"},"Courier Status",-1),Je={class:"col-2 q-ml-lg q-mt-lg"},Xe={class:"q-ml-md q-mt-lg q-mr-lg q-pa-md"},Ze={class:"row justify-start items-center"},et=s("span",{class:"q-ml-sm"},null,-1),tt={class:"row justify-start items-center"},lt=s("span",{class:"q-ml-sm"},null,-1),at={class:"row justify-start items-center"},rt=s("span",{class:"q-ml-sm"},null,-1),ot={key:0,class:"q-ml-md q-mt-sm q-mr-lg q-pa-md"},Ct={__name:"OrdersPage",setup(y){const a=ve(),_=u(!1),c=u(!1),{orders:v}=ge(a);let h=[{name:"orderId",required:!0,label:"Order Id",align:"left",field:l=>l.order_id,format:l=>`${l}`,sortable:!0},{name:"orderDate",label:"Order Date",field:"order_date",sortable:!0,align:"center"},{name:"customerName",label:"Customer Name",field:"customer_name",align:"center"},{name:"mobileNumber",label:"Mobile Number",field:"mobile_number",align:"center"},{name:"referrerId",label:"Referrer Id",field:"referrer_id",align:"center"},{name:"referrerName",label:"Referrer Name",field:"referrer_name",align:"center"},{name:"referrerMobileNumber",label:"Referrer Mobile Number",field:"referrer_mobile_number",align:"center"},{name:"totalProductPrice",label:"Total Product Price",field:"total_product_price",align:"center"},{name:"cgst",label:"CGST Amount",field:"order_cgst_amount",align:"center"},{name:"sgst",label:"SGST Amount",field:"order_sgst_amount",align:"center"},{name:"igst",label:"IGST Amount",field:"order_igst_amount",align:"center"},{name:"gstTotal",label:"GST Total Amount",field:"order_gst_total_amount",align:"center"},{name:"orderTotal",label:"Order Total Amount",field:"order_total_amount",align:"center"},{name:"orderStatus",label:"Order Status",field:"order_status",align:"center"},{name:"courierDate",label:"Courier Date",field:"courier_date",align:"center"},{name:"deliveryThrough",label:"Courier Company Name",field:"delivery_through",align:"center"},{name:"deliveryNumber",label:"Courier Tracking Number",field:"delivery_number",align:"center"},{name:"deliveryAddress",label:"Delivery Address",field:"delivery_address",align:"center"},{name:"deliveryDate",label:"Delivery Date",field:"delivery_date",align:"center"},{name:"paymentMode",label:"Payment Mode",field:"payment_mode",align:"center"},{name:"paymentStatus",label:"Payment Status",field:"payment_status",align:"center"},{name:"paymentDate",label:"Payment Date",field:"payment_date",align:"center"},{name:"paymentReference",label:"Payment Reference",field:"payment_reference",align:"center"}],x=[{name:"uid",required:!0,label:"Order Item Id",align:"left",field:l=>l.order_item_number,format:l=>`${l}`,sortable:!0},{name:"productName",label:"Product Name",field:"product_name",align:"center"},{name:"quantity",label:"Quantity",field:"quantity",align:"center"},{name:"hsnCode",label:"HSN Code",field:"hsn_code",align:"center"},{name:"price",label:"Price (INR)",field:"price",align:"center"},{name:"cgstPercentage",label:"CGST (%)",field:"cgst_percentage",align:"center"},{name:"cgstAmount",label:"CGST Amount (INR)",field:"cgst_amount",align:"center"},{name:"sgstPercentage",label:"SGST (%)",field:"sgst_percentage",align:"center"},{name:"sgstAmount",label:"SGST Amount (INR)",field:"sgst_amount",align:"center"},{name:"igstPercentage",label:"IGST (%)",field:"igst_percentage",align:"center"},{name:"igstAmount",label:"IGST Amount (INR)",field:"igst_amount",align:"center"},{name:"gstTotalAmount",label:"GST Total (INR)",field:"gst_total_amount",align:"center"},{name:"totalAmount",label:"Total (INR)",field:"total_amount",align:"center"}];const T=u(h),f=u([]),P=u(x),D=u([]),p=u([]),V=u(""),Q=u(!1),N=u("All"),C=u(""),O=u("");let E=[{label:"all",name:"All"},{label:"yet_to_be_couriered",name:"Yet to be Couriered"},{label:"in_transit",name:"In transit"},{label:"delivered",name:"Delivered"},{label:"cancelled",name:"Cancelled"}];const H=u("Orders Template Download"),W=u("Orders Data Upload"),$=pe(),z=b(()=>E.map(l=>l.name)),Y=b(()=>E.find(t=>t.name===N.value).label),U=b(()=>!C.value||!O.value),w=()=>{$.loading.show({spinner:_e,spinnerColor:"light-blue",messageColor:"white",backgroundColor:"light-blue",message:""})},R=()=>{$.loading.hide()},B=(l=!1)=>{_.value=!1,l===!0&&(p.value=[],r())},J=(l=!1)=>{c.value=!1,l===!0&&r()},i=()=>{_.value=!0},d=l=>l==="Yet to be Couriered"?"orange":l==="In Transit"?"purple":l==="Delivered"?"green":"red",r=()=>{w();let l={fromDate:C.value,toDate:O.value,orderStatus:Y.value};a.getOrders(l).then(t=>{v.value=t.data,f.value=t.data}).catch(t=>{console.log("errror",t)}).finally(()=>{R()})},M=()=>{let l=v.value.find(t=>t.order_id===p.value[0].order_id).order_items;D.value=l},j=()=>{if(O.value<C.value){$.notify({message:"Order From Date should be less than or equal to Order To Date!!!",type:"warning",position:"top"});return}p.value=[],r()},L=()=>{w();let l={fromDate:C.value,toDate:O.value,orderStatus:Y.value};a.getOrdersCsvTemplate(l).then(t=>{let n=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=n,o.setAttribute("download","Yet_To_Be_Couriered_Orders.csv"),document.body.appendChild(o),o.click(),o.remove()}).catch(t=>{console.log("err",t)}).finally(()=>{R()})},X=()=>{w();let l=N.value.replace(/ /g,"_"),t="Registration_Payments_All.xlsx";U.value||(t=`Registration_Payments_${l}_from_${C.value}_to_${O.value}.xlsx`);let n=[];for(let o of f.value){let fe={"Order Id":o.order_id,"Order Date":o.order_date,"Customer Name":o.customer_name,"Mobile Number":o.mobile_number,"Referrer Id":o.referrer_id,"Referrer Name":o.referrer_name,"Referrer Mobile Number":o.referrer_mobile_number,"Total Product Price":o.total_product_price,"CGST Amount":o.order_cgst_amount,"SGST Amount":o.order_sgst_amount,"IGST Amount":o.order_igst_amount,"GST Total Amount":o.order_gst_total_amount,"Order Total Amount":o.order_total_amount,"Order Status":o.order_status,"Courier Date":o.courier_date,"Courier Company Name":o.delivery_through,"Courier Tracking Number":o.delivery_number,"Delivery Address":o.delivery_address,"Delivery Date":o.delivery_date,"Payment Mode":o.payment_mode,"Payment Status":o.payment_status,"Payment Date":o.payment_date};n.push(fe)}Se(n,t),R()};return ye(p,l=>{l.length?M():D.value=[]}),(l,t)=>(q(),Z(he,null,[s("div",Be,[s("div",je,[Le,e(I,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=n=>C.value=n),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),s("div",Ke,[He,e(I,{modelValue:O.value,"onUpdate:modelValue":t[1]||(t[1]=n=>O.value=n),style:{"max-width":"150px"},outlined:"",dense:"",autofocus:"",type:"date"},null,8,["modelValue"])]),s("div",We,[ze,e(ce,{filled:"",dense:"",style:{width:"200px","max-height":"100px"},modelValue:N.value,"onUpdate:modelValue":t[2]||(t[2]=n=>N.value=n),options:g(z)},null,8,["modelValue","options"])]),s("div",Je,[e(S,{unelevated:"",color:"primary",label:"Search","no-caps":"",disable:g(U),onClick:j},null,8,["disable"])])]),s("div",Xe,[s("div",null,[e(S,{color:"green",class:"q-mb-md",style:{width:"20px"},"no-caps":"",onClick:X},{default:m(()=>[s("div",Ze,[e(K,{name:"fas fa-file-excel"}),et])]),_:1}),N.value==="Yet to be Couriered"?(q(),A(S,{key:0,color:"primary",class:"q-mb-md float-right",style:{width:"20px"},"no-caps":"",disable:g(U)||!f.value.length,onClick:t[3]||(t[3]=n=>c.value=!0)},{default:m(()=>[e(te,{content:W.value,"max-width":"20rem"},null,8,["content"]),s("div",tt,[e(K,{name:"fas fa-upload"}),lt])]),_:1},8,["disable"])):k("",!0),N.value==="Yet to be Couriered"?(q(),A(S,{key:1,color:"primary",class:"q-mb-md float-right q-mr-md",style:{width:"20px"},"no-caps":"",disable:g(U)||!f.value.length,onClick:L},{default:m(()=>[e(te,{content:H.value,"max-width":"20rem"},null,8,["content"]),s("div",at,[e(K,{name:"fas fa-download"}),rt])]),_:1},8,["disable"])):k("",!0)]),e(ee,{class:"orders-table",flat:"",bordered:"",title:"Orders",rows:f.value,columns:T.value,"row-key":"order_id",selection:"single",selected:p.value,"onUpdate:selected":t[6]||(t[6]=n=>p.value=n),filter:V.value},{"top-right":m(()=>[Q.value?(q(),A(I,{key:0,filled:"",borderless:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=n=>V.value=n),placeholder:"Search"},{append:m(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])):k("",!0),e(S,{class:"q-ml-sm",icon:"filter_list",onClick:t[5]||(t[5]=n=>Q.value=!Q.value),flat:""})]),"body-cell-orderStatus":m(n=>[e(we,{props:n},{default:m(()=>[e(De,{color:d(n.row.order_status),"text-color":"white",dense:"",class:"text-weight-bolder",square:""},{default:m(()=>[ae(re(n.row.order_status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected","filter"]),e(S,{class:"q-mt-md",color:"primary",label:"Edit",disable:!p.value.length||p.value[0].order_status==="Delivered",onClick:i},null,8,["disable"])]),p.value.length?(q(),Z("div",ot,[e(ee,{class:"orders-table",flat:"",bordered:"",title:"Order Items",rows:D.value,columns:P.value,"row-key":"order_id",filter:V.value},null,8,["rows","columns","filter"])])):k("",!0),_.value?(q(),A($e,{key:1,modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=n=>_.value=n),"show-new-user-popup":_.value,"close-new-user-popup":B,"selected-data":p.value},null,8,["modelValue","show-new-user-popup","selected-data"])):k("",!0),c.value?(q(),A(Ye,{key:2,modelValue:c.value,"onUpdate:modelValue":t[8]||(t[8]=n=>c.value=n),"show-orders-file-upload-popup":c.value,"close-orders-file-upload-popup":J},null,8,["modelValue","show-orders-file-upload-popup"])):k("",!0)],64))}};export{Ct as default};
